<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ETC1010 - 5510: Introduction to Data Analysis</title>
    <meta charset="utf-8" />
    <meta name="author" content="Patricia Menéndez" />
    <script src="libs/header-attrs-2.10/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
    <!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 
    -->
    <link rel="icon" href="images/favicon.ico"  type='image/x-icon'/>    
    <link rel="stylesheet" href="assets/animate.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-logo.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-brand.css" type="text/css" />
    <link rel="stylesheet" href="assets/monash-fonts.css" type="text/css" />
    <link rel="stylesheet" href="assets/styles.css" type="text/css" />
    <link rel="stylesheet" href="assets/custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




background-image: url(images/daniel-olah-pCcGpVsOHoo-unsplash.jpg)
background-size: cover
class: hide-slide-number split-70 title-slide
count: false

.column.shade_black[.content[

&lt;br&gt;

# .monash-white.outline-text[ETC1010 - 5510: Introduction to Data Analysis]

&lt;h2 class="monash-white outline-text" style="font-size: 30pt!important;"&gt;Week 5&lt;/h2&gt;

&lt;br&gt;

&lt;h2 style="font-weight:900!important;"&gt;Week of missing values&lt;/h2&gt;

.bottom_abs.width100[

Lecturer: *Patricia Menéndez*

Department of Econometrics and Business Statistics




&lt;br&gt;
]


]]



&lt;div class="column transition monash-m-new delay-1s" style="clip-path:url(#swipe__clip-path);"&gt;
&lt;div class="background-image" style="background-image:url('images/large.png');background-position: center;background-size:cover;"&gt;
&lt;svg class="clip-svg absolute"&gt;
&lt;defs&gt;
&lt;clipPath id="swipe__clip-path" clipPathUnits="objectBoundingBox"&gt;
&lt;polygon points="0.5745 0, 0.5 0.33, 0.42 0, 0 0, 0 1, 0.27 1, 0.27 0.59, 0.37 1, 0.634 1, 0.736 0.59, 0.736 1, 1 1, 1 0, 0.5745 0" /&gt;
&lt;/clipPath&gt;
&lt;/defs&gt;	
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;





---
# Questions/Comments/Suggestions

&lt;img src="images/rhythm-goyal-_-Ofoh09q_o-unsplash.jpg" width="80%" style="display: block; margin: auto;" /&gt;
 Photo: Rhythm Goyal for  Unsplash.
 
---
# Tutorial replacements for Friday
&lt;br&gt;&lt;br&gt;
- Tutorial/02.ETC5510 (Chin Quek) Wed 31st at 4.30pm. --&gt; online (usually Fridays 4pm)
- Tutorial/05.ETC5510 (Samithree Rajapaksha) Tues 30th at 9.00am. --&gt; online  (usually Fridays 12pm)
- Tutorial/12_LiveStream.ETC5510 (Nitika Kandhari) Thurs 1st at 2.00pm. --&gt; online
  (usually Fridays 4pm)
 
---
# Recap: Week 4
&lt;br&gt;&lt;br&gt;

- What is relational data?
- Combining different data sets for data analysis
- Keys
- Different sorts of joins
- Color Palettes  and effective graphs
- Maps
- Debugging


---

# Week 5: Outline
&lt;br&gt;&lt;br&gt;
-  What even are missing values?

- How to start looking at missing data?

- How to start exploring missing data?

- How to impute (fill in) Missing values?

- Different file formats
    - Audio / binary










---
class: center
# Example


San Francisco weather data 

|| Date | Wind | Temp ||

Using the R package: [`GSODR`](https://data.noaa.gov/dataset/dataset/global-surface-summary-of-the-day-gsod)

[(Global Surface Summary of the Day)](https://data.noaa.gov/dataset/dataset/global-surface-summary-of-the-day-gsod)

Written by Adam Sparks

github.com/ropensci/GSODR
---

&lt;img src="Workshop1-Week5_files/figure-html/sf-intro-temp-data-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---
class: transition

# These gaps are missing values! 

Typically encoded as NA's

---

# Some Questions

&lt;br&gt;&lt;br&gt;

.content-box-neutral[

- What are some reasons this might be a problem?
- What is missing? 
- Why are they missing?
- How can we summarise and explore this?
]


---
# One way to show missing data

&lt;img src="Workshop1-Week5_files/figure-html/sf-final-miss-mech2-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---
# What do we see in that plot?
&lt;br&gt;&lt;br&gt;

We can create a graphic where we can see the data that are present are in blue, and the data that are missing are in red. What we see here then is that the data that are missing for air temperature are in red here, but are actually measured only beyond gust speeds of 8 kpmh

So in cases of strong winds, the air temperature measurements break. 

---

# Where do the missing values come from?
&lt;br&gt;&lt;br&gt;

.content-box-neutral[
- In many cases, it is obvious to point out the precise mechanism that generated missing values.
- However, in most cases knowning the reason why we have missing values in the data is difficult specially when there is a lot of missing data, or when there are many variables.  
]




---
# Learn more about missing values

&lt;img src="https://imgs.njtierney.com/hex-visdat-and-naniar.png" width="70%" style="display: block; margin: auto;" /&gt;

.pull-left[
.center[

visdat.njtierney.com

]
]

.pull-right[
.center[

naniar.njtierney.com

]
]



---
# What are missing values?
&lt;br&gt;

&gt; Missing values are values that should have been recorded but were not.

.content-box[`NA` = **N**ot **A**vailable.]

- .green[Missing values are values that should have been recorded, but were not.]

Think of it this way: 

- You might accidentally not record seeing a bird - this is a missing value. 
- This is different to recording that there were no birds observed.

.green[R stores missing values as `NA`, which stands for **N**ot **A**vailable.]


---
# How do I check if I have missing values?
**Using the R package .purple[naniar]**

```r
x &lt;- c(1, NA, 3, NA, NA, 5)
```

```r
library(naniar)
any_na(x)   # Is there any missing values?
```

```
[1] TRUE
```

```r
are_na(x)   # Is a vector entry missing?

```

```
[1] FALSE  TRUE FALSE  TRUE  TRUE FALSE
```

```r
n_miss(x)  # what is the number of missing values?
```

```
[1] 3
```

```r
prop_miss(x)  # What is the proportion of missing values?
```

```
[1] 0.5   # 3/6  = 0.5 
```

---
# Missing values 

- Missing values don't jump out and scream "I'm here!". 
- They're usually hidden, like a needle in a haystack.
- To detect missing values use `any_na`, which returns TRUE if there are any missings, and FALSE if there are none.
- `are_na` asks "are these NA?" and returns TRUE/FALSE for each value
- `are_na` shows us 3 TRUE values - 3 missing values.
- To avoid counting each TRUE yourself, `n_miss` counts the number of missings
- And `prop_miss` gives the proportion of missings, which gives important context: 50% of data is missing!


---
# Working with missing data
&lt;br&gt;&lt;br&gt;
.green[Remember the assignment - na.rm = TRUE?]

Reason: 

`NA` + [anything] = `NA`

```r
heights
```

```
Sophie    Dan   Fred 
   165    177     NA 
```

```r
sum(heights)
```

```
[1] NA
```

---
# Working with missing data

&lt;br&gt;&lt;br&gt;

`na.rm = TRUE` will remove missings values from an operation

```r
sum(heights, na.rm = TRUE)
```

```
[1] 342
```

**Use this `responsibly` and knowing what you are doing!!**

---

# Dangers of removing missing values

.green[You can remove most of or all of your data:]


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; x &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; y &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; z &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Dangers of removing missing values
&lt;br&gt;&lt;br&gt;
You can remove most of or all of your data:


```r
vis_miss(dat_df)
```

&lt;img src="Workshop1-Week5_files/figure-html/vis-miss-dat-df-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# Dangers of removing missing values
&lt;br&gt;&lt;br&gt;
You can remove most of or all of your data:
&lt;br&gt;&lt;br&gt;

```r
na.omit(dat_df)
## [1] x y z
## &lt;0 rows&gt; (or 0-length row.names)
```
&lt;br&gt;&lt;br&gt;
When you were not intending to do that!

---

# `na.omit` / `na.rm` = listwise delection

|  x|  y|  z|
|--:|--:|--:|
| ~~NA~~|  ~~1~~|  ~~1~~|
| ~~NA~~|  ~~2~~|  ~~2~~|
| ~~NA~~|  ~~3~~|  ~~3~~|
|  ~~4~~| ~~NA~~|  ~~4~~|
|  ~~5~~| ~~NA~~|  ~~5~~|
|  ~~6~~| ~~NA~~|  ~~6~~|
|  ~~7~~|  ~~7~~| ~~NA~~|
|  ~~8~~|  ~~8~~| ~~NA~~|
|  ~~9~~|  ~~9~~| ~~NA~~|

---

# `na.omit` / `na.rm` = listwise delection

|  x|  y|  z|
|--:|--:|--:|
| ~~NA~~|  ~~1~~|  ~~1~~|
| ~~NA~~|  ~~2~~|  ~~2~~|
| ~~NA~~|  ~~3~~|  ~~3~~|
|  4| NA|  4|
|  5| NA|  5|
|  6| NA|  6|
|  7|  7| NA|
|  8|  8| NA|
|  9|  9| NA|

---

# `na.omit` / `na.rm` = listwise delection

|  x|  y|  z|
|--:|--:|--:|
| ~~NA~~|  ~~1~~|  ~~1~~|
| ~~NA~~|  ~~2~~|  ~~2~~|
| ~~NA~~|  ~~3~~|  ~~3~~|
|  ~~4~~| ~~NA~~|  ~~4~~|
|  ~~5~~| ~~NA~~|  ~~5~~|
|  ~~6~~| ~~NA~~|  ~~6~~|
|  7|  7| NA|
|  8|  8| NA|
|  9|  9| NA|

---

# `na.omit` / `na.rm` = listwise delection

|  x|  y|  z|
|--:|--:|--:|
| ~~NA~~|  ~~1~~|  ~~1~~|
| ~~NA~~|  ~~2~~|  ~~2~~|
| ~~NA~~|  ~~3~~|  ~~3~~|
|  ~~4~~| ~~NA~~|  ~~4~~|
|  ~~5~~| ~~NA~~|  ~~5~~|
|  ~~6~~| ~~NA~~|  ~~6~~|
|  ~~7~~|  ~~7~~| ~~NA~~|
|  ~~8~~|  ~~8~~| ~~NA~~|
|  ~~9~~|  ~~9~~| ~~NA~~|

---
class: transition

# Important!
&lt;br&gt;&lt;br&gt;

- na.rm or na.omit can remove entire rows containing missings
- This is bad because you can lose data - sometimes all your data! This might not be what you anticipate!
- It can also mean that you are removing / censoring observations.



---
# Dangers of removing missing values

You can introduce bias - what happens when you remove the NAs? 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; temp &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; location &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; inside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; inside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; outside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; inside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; outside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; outside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; outside &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; inside &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



---
# Dangers of removing missing values
&lt;br&gt;&lt;br&gt;
.green[So what happens when we mix missing values with our calculations?] 
.content-box[
We need to know what happens, so we can be primed to find these cases. The general rule is this:]
&lt;br&gt;&lt;br&gt;

- Calculations with `NA` return `NA`.

- Say you have the height of three friends: Sophie,  Dan, and Fred.

- The sum of their heights returns `NA`, 

.content-box[This is because we don't know the sum of a number and NA.]


---
# Introduction to missingness summaries

&lt;br&gt;&lt;br&gt;

- Now that you understand what missing values are,
how to count them, and how they operate, let's scale these up to more detailed summaries of missingness.

- We need to summarise missing data to identify variables, 
cases, or patterns of missingness, as these can bias our data analysis.


---
# Introduction to missingness summaries


**.green[Basic summaries of missingness (R package narniar):]**

- `n_miss`  --&gt; number of missing values
- `n_complete` --&gt; Total number of values - missing values (complete values)

**.green[Dataframe summaries of missingness (R package narniar):]**

- `miss_var_summary` --&gt; Number of variables with missing values
- `miss_case_summary` --&gt; Number of cases with missing values

These functions work with `dplyr::group_by` and return the number and percentage of missings in each variable or case
so you can fluidly explore missingness for different groups.


---
# Naniar
&lt;br&gt;&lt;br&gt;

.content-box[
`naniar` provides a family of functions all starting with `miss_`., which each provide different summaries of missingness, and return a dataframe.]


&lt;!-- --- --&gt;
&lt;!-- # Introduction to missingness summaries --&gt;

&lt;!-- .green[There are two main summaries: **basic, and dataframe summaries**.] --&gt;

&lt;!-- - Basic summaries return a single number, like the number of missing or complete values using `n_miss` or `n_complete`.  --&gt;
&lt;!-- - However, you will need more detailed missingness summaries to help you on your journey through a data analysis.  --&gt;

&lt;!-- - `naniar` provides a family of functions all starting with `miss_`., which each provide different summaries of missingness, and return a dataframe.  --&gt;

&lt;!-- - This allows us to see features that can be difficult to articulate, or time consuming to calculate.  --&gt;

&lt;!-- - For example, `miss_var_summary` and `miss_case_summary` return the number and percentage of missings in each variable or case. --&gt;

&lt;!-- - These summaries work with `dplyr`''s `group_by`, so you can fluidly explore missingness by each groups. --&gt;




---
# Missing data summaries: Variables
&lt;br&gt;&lt;br&gt;

```r
miss_var_summary(dat_sf_clean)
## # A tibble: 6 × 3
##   variable       n_miss pct_miss
##   &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt;
## 1 temp_min           70    17.3 
## 2 temp_max           70    17.3 
## 3 temp_avg           70    17.3 
## 4 wind_speed_max     23     5.68
## 5 date                0     0   
## 6 month               0     0
```
.content-box[For example, temp_max has .green[70 missing value]s, and is about .green[17.3] percent missing.]

---
# Missing data summaries: Variables example
&lt;br&gt;&lt;br&gt;
- Use `miss_var_summary` to summarise the number of missings in each variable. 

- This returns a dataframe where each row is a variable. It also includes summaries of the number and percentage of missings for each variable in the dataset, and is sorted by the number of missings.

&lt;br&gt;&lt;br&gt;
.content-box[For example, temp_max has 70 missing values, and is about 17.3 percent missing.]


---
# Missing data summaries: Cases (rows)
&lt;br&gt;&lt;br&gt;

- Similar to `miss_var_summary`, `miss_case_summary` returns a summary dataframe, .green[where each case  represents a dataset row number.]

- .purple[n_miss] --&gt; number a variables that have a missing case for a given row
- .purple[pct_miss] --&gt; percentage of missing accross all the variables

---
# Missing data summaries: Cases example
&lt;br&gt;&lt;br&gt;

.left-code[

```r
miss_case_summary(dat_sf_clean)
## # A tibble: 405 × 3
##     case n_miss pct_miss
##    &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
##  1    89      4     66.7
##  2   182      4     66.7
##  3   188      4     66.7
##  4   271      4     66.7
##  5     6      3     50  
##  6     7      3     50  
##  7    10      3     50  
##  8    29      3     50  
##  9    37      3     50  
## 10    39      3     50  
## # … with 395 more rows
```

]
.right-code[
.content-box[Here, case 5 - the fifth row in the dataset - has variables with 3 missing values for that case, which means 50% of the variables have mising values for that case/row.]
]
---
# Missing data tabulations: variables
&lt;br&gt;&lt;br&gt;

```r
miss_var_table(dat_sf_clean)
## # A tibble: 3 × 3
##   n_miss_in_var n_vars pct_vars
##           &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
## 1             0      2     33.3
## 2            23      1     16.7
## 3            70      3     50
```
- .purple[n_miss_in_var] number of missing values
- .purple[n_vars] in how many variables?
---
# Missing data tabulations: cases
&lt;br&gt;&lt;br&gt;
- Tabulation of missingness counts the number of times there are 0, 1, 2, 3, and so on, missings. They are very useful, compact summaries that reveal interesting structure.

- `miss_var_table` .green[returns a dataframe with the number of missings in a variable, and the number and percentage of variables affected.] 


- Similarly, `miss_case_table` returns the same information, but for cases.

---
# Missing data tabulations: cases example
&lt;br&gt;&lt;br&gt;

```r
miss_case_table(dat_sf_clean)
## # A tibble: 4 × 3
##   n_miss_in_case n_cases pct_cases
##            &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
## 1              0     316    78.0  
## 2              1      19     4.69 
## 3              3      66    16.3  
## 4              4       4     0.988
```
 - .purple[n_miss_in_case] --&gt; number of missing values 
 - .purple[n_cases] --&gt; number of cases or rows that have the n_miss_in_case number of missing values



---
# Missing values accross gruups
&lt;br&gt;&lt;br&gt;
Sometimes you are interested in missingness for groups in the data.

.content-box-soft[
- Each missingness summary function can be calculated by group, using `group_by` from `dplyr`.

- For example, we can look at the missingness by Month in the airquality dataset.
]

---
# Using summaries with `group_by`


```r
dat_sf_clean %&gt;%
  group_by(month) %&gt;%
  miss_var_summary()
## # A tibble: 60 × 4
## # Groups:   month [12]
##    month variable       n_miss pct_miss
##    &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt;
##  1     1 temp_min            7    11.5 
##  2     1 temp_max            7    11.5 
##  3     1 temp_avg            7    11.5 
##  4     1 wind_speed_max      4     6.56
##  5     1 date                0     0   
##  6     2 temp_min            5    12.8 
##  7     2 temp_max            5    12.8 
##  8     2 temp_avg            5    12.8 
##  9     2 wind_speed_max      4    10.3 
## 10     2 date                0     0   
## # … with 50 more rows
```





---
# Introduction to missing data visualisations in naniar
&lt;br&gt;&lt;br&gt;

- Visualisation can quickly capture an idea or thought.
- `naniar` provides a friendly family of missing data visualization functions.
- Each visualization corresponds to a data summary.
- Visualisations help you operate closer to the speed of thought.


&lt;!-- --- --&gt;

&lt;!-- We cover how to get a bird's eye view of the data, how to look at missings in the variables and cases, and how to generate visualizations for missing spans and across groups in the data. --&gt;

&lt;!-- We now know what missing values are, how they work, how to count and summarise them - now let's look at some of the built-in visualisations that come with `naniar`. --&gt;

&lt;!-- Data summaries are very useful, but sometimes an idea or a thought can be quickly captured with a visualisation.  --&gt;

&lt;!-- `naniar` provides a friendly family of missing data visualisation functions, each presenting different visualisations missingness summaries. --&gt;

&lt;!-- In fact, each of these visualisations is a nice compact shorthand for the data summaries. While you could create similar and more complex visualisations using the summary information from the previous lesson, this can be repetitive. The visualisations in `naniar` reduce repetition and increase iteration, so you can operate closer to the speed of thought. --&gt;

---
# Get a bird's eye view of the missing data


```r
vis_miss(dat_sf_clean)
```

&lt;img src="Workshop1-Week5_files/figure-html/aq-vis-miss-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---
# Data overview
&lt;br&gt;
- When you first get a dataset, it can be difficult to get a visceral sense of **where** the missings are. 

- To get an overview of the amount of missingness, use the `vis_miss` function from the `visdat` package. 

- `vis_miss` produces a "heatmap" of the missingness - like as if the plot corresponded to the dataset as a giant spreadsheet, with values coloured black for missing, and grey for present.

- `vis_miss` also provides missingness summary statistics, showing the overall percentage of missingness in the legend, and the amount of missings in each variable. 

- These can be turned off in its options, described in the helpfile.


---
# Clustering the missing data by re-ordering rows

&lt;br&gt;&lt;br&gt;

`vis_miss` also allows for clustering of the missing data by setting `cluster = TRUE` --&gt; this orders the rows by missingness to identify common co-occurrences.

---
# Get a bird's eye view of the missing data


```r
vis_miss(dat_sf_clean, cluster = TRUE)
```

&lt;img src="Workshop1-Week5_files/figure-html/aq-vis-miss-cluster-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# Visualizing missing in variables and cases

- To quickly show the missingness in variables and cases, we visualise them using `gg_miss_var` and `gg_miss_case`. Note that these are visual analogues of the `miss_var_summary` and `miss_case_summary` functions.

- These plots show the amount of missingness on the x axis, and for `gg_miss_var`, each point represents the amount of missingness in that variable, and for `gg_miss_case`, each line represents the amount of missingness in that case.

- Note that these visualisations are ordered so that the most missing is at the top. The ordering in `gg_miss_case` can be turned off with option, `order_cases = FALSE`.

---
# Look at missings in variables


```r
gg_miss_var(dat_sf_clean)
```

&lt;img src="Workshop1-Week5_files/figure-html/aq-gg-miss-var-1.png" width="80%" style="display: block; margin: auto;" /&gt;
Lollipop chart

---
# Look at missings in cases


```r
gg_miss_case(dat_sf_clean)
```

&lt;img src="Workshop1-Week5_files/figure-html/aq-gg-miss-case-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# Visualizing missing by facets

&lt;br&gt;&lt;br&gt;

.content-box-soft[
`gg_miss_var` and `gg_miss_case` also allow for facetting by one variable.
]
&lt;br&gt;&lt;br&gt;
- This means you can explore missingness in cases and variables across the levels of another group. 

- This plot is facetted by month, showing the number of missings in each variable for each month.



---
# Look at missings in variables using facets


```r
gg_miss_var(dat_sf_clean, facet = month)
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# Visualizing combinations
&lt;br&gt;&lt;br&gt;
To visualise the common combinations of missingness - which variables and cases go missing together, use `gg_miss_upset`. 

This powerful visualisation shows the number of combinations of missing values that co-occur.



---
# Visualizing missingness patterns


```r
gg_miss_upset(dat_sf_clean)
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;" /&gt;

&lt;!-- An upset plot of the `airquality` dataset shows there are only missing values in Ozone and Solar.R, with 35 in only Ozone, 5 in Solar.R, and in both Ozone and Solar.R, there are 2 missing cases. --&gt;



---
class: middle
# Functions

.pull-left[
# `miss_*`
# `miss_var_*`
# `miss_case_*`
]


.pull-right[
# `gg_miss_*`
# `gg_miss_var`
# `gg_miss_case`
]


---
class: transition

# Representing _Missing_ values in a _Tidy_ Way

---
# Tidy Data

.pull-left[

Variables in columns

Observations in Rows

One value per cell
]

.pull-right[
&lt;img src="images/ex-tidy-data.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---


# Data Shadow

.pull-left[
Variable ends in NA

Values are missing (NA) or not (!NA)
]

.pull-right[
&lt;img src="images/ex-shadow-data.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: center middle

# Tidy Missing Data 

`bind_shadow(data)`

&lt;img src="images/ex-tidy-missing-data.png" width="60%" style="display: block; margin: auto;" /&gt;

---


# `bind_shadow()`


```r

bind_shadow(dat_sf_clean) %&gt;% glimpse()
## Rows: 405
## Columns: 12
## $ date              &lt;date&gt; 2017-01-02, 2017-01-03, 2017-01-04, 2017-01-05, 201…
## $ month             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ temp_min          &lt;dbl&gt; 5.9, 8.4, 10.4, 5.8, 4.4, NA, NA, 11.9, 11.9, NA, 6.…
## $ temp_max          &lt;dbl&gt; 10.5, 11.1, 14.5, 9.4, 9.1, NA, NA, 16.0, 14.6, NA, …
## $ temp_avg          &lt;dbl&gt; 8.4, 9.7, 12.4, 8.1, 6.4, NA, NA, 13.5, 13.2, NA, 8.…
## $ wind_speed_max    &lt;dbl&gt; 5.1, 5.1, 6.7, 5.1, 5.1, 8.8, 8.2, 7.2, 7.7, 8.2, 5.…
## $ date_NA           &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !N…
## $ month_NA          &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !N…
## $ temp_min_NA       &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, NA, NA, !NA, !NA, NA, !NA, …
## $ temp_max_NA       &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, NA, NA, !NA, !NA, NA, !NA, …
## $ temp_avg_NA       &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, NA, NA, !NA, !NA, NA, !NA, …
## $ wind_speed_max_NA &lt;fct&gt; !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !NA, !N…
```

---
# Shadows In Practice: Explore one variable


```r

dat_sf_clean %&gt;% 
  ggplot(aes(x = wind_speed_max)) + 
  geom_density()
```

&lt;img src="Workshop1-Week5_files/figure-html/shadow-plot-no-na-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---
# Shadows In Practice: Explore one variable


```r

dat_sf_clean %&gt;%
bind_shadow() %&gt;% #&lt;&lt;    # Distribution of wind when temp is missing and when it is not
  ggplot(aes(x = wind_speed_max,
*          colour = temp_avg_NA)) +
  geom_density()
```

&lt;img src="Workshop1-Week5_files/figure-html/shadow-plot-2-1.png" width="60%" style="display: block; margin: auto;" /&gt;


---
# In Practice: Explore two variables
&lt;br&gt;&lt;br&gt;

.left-code[

```r
ggplot(dat_sf_clean, 
       aes(x = temp_avg, 
           y = wind_speed_max)) + 
  geom_point()

```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-explore-two-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---
class: transition
#Imputing  missing values

---
# Impute shadow values into our realm
&lt;br&gt;&lt;brr&gt;
.pull-left[

```
## # A tibble: 7 × 2
##   temp_avg temp_avg_NA
##      &lt;dbl&gt; &lt;fct&gt;      
## 1      8.4 !NA        
## 2      9.7 !NA        
## 3     12.4 !NA        
## 4      8.1 !NA        
## 5      6.4 !NA        
## 6     NA   NA         
## 7     NA   NA
```
]


.pull-right[

```
## # A tibble: 7 × 2
##   temp_avg temp_avg_NA
##      &lt;dbl&gt; &lt;fct&gt;      
## 1     8.4  !NA        
## 2     9.7  !NA        
## 3    12.4  !NA        
## 4     8.1  !NA        
## 5     6.4  !NA        
## 6     5.66 NA         
## 7     5.69 NA
```
]


&lt;!-- One approach, (ggobi) is to **shift** missing values below the minimum value --&gt;

&lt;!-- This then means that they can be plotted on the same axis. --&gt;

&lt;!-- Typically, when exploring this data, you would do something like this: --&gt;

&lt;!-- The problem with this is that ggplot does not handle missings be default, and removes the missing values. This makes it hard to explore the missing values. --&gt;

---
# `impute_below()`

# Impute missing values from the shadows into our realm


```r
dat_sf_clean %&gt;%
  slice(5:10) %&gt;%
* mutate(temp_avg_shift = impute_below(temp_avg)) %&gt;%
  select(temp_avg, temp_avg_shift)
## # A tibble: 6 × 2
##   temp_avg temp_avg_shift
##      &lt;dbl&gt;          &lt;dbl&gt;
## 1      6.4           6.4 
## 2     NA             5.73
## 3     NA             5.74
## 4     13.5          13.5 
## 5     13.2          13.2 
## 6     NA             5.53
```

---
# `geom_miss_point()`
&lt;br&gt;&lt;br&gt;

.left-code[

```r
ggplot(dat_sf_clean, 
       aes(x = wind_speed_max, 
           y = temp_avg)) + 
* geom_miss_point()

```
.purple[geom_miss_point] provides a way to transform and plot missing values in ggplot2. 
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-geom-miss-point-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.small[
.green[.purple[geom_miss_point] uses functions  from ggobi and manet, where missing values (“NA”) are replaced with values 10% lower than the minimum value in that variable and plot in red on the figure.]
]
---
class: center

# Facets!

&lt;img src="Workshop1-Week5_files/figure-html/ggmissing-facet-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---
class: transition
# Exploring imputed values


Imputation is the process of filling in missing values with some other estimate

---
# What about this imputation thing? 


```r

dat_sf_clean %&gt;%  
  as.data.frame() %&gt;% 
* simputation::impute_lm(temp_avg ~ wind_speed_max) %&gt;%
  ggplot(aes(x = date,
             y = temp_avg)) + 
  geom_point()
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-10-1.png" width="60%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;
Where are the inputed values? They are **invisible!**


---
# Tidy Missing Data reveals the imputations!


```r

*bind_shadow(dat_sf_clean) %&gt;%
  as.data.frame() %&gt;% 
  simputation::impute_lm(temp_avg ~ wind_speed_max + date) %&gt;%
  as_tibble() %&gt;% 
  ggplot(aes(x = date,
             y = temp_avg,
*            colour  = temp_avg_NA)) +
  geom_point() +
  scale_colour_brewer(palette = "Dark2")
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-11-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Shadows make things clearer!


```r
*bind_shadow(dat_sf_clean) %&gt;%
  as.data.frame() %&gt;% 
  simputation::impute_lm(temp_avg ~ wind_speed_max) %&gt;%
  ggplot(aes(x = temp_avg,
*            fill = wind_speed_max_NA)) +
  geom_density(alpha = 0.5) 
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-12-1.png" width="60%" style="display: block; margin: auto;" /&gt;


---
# Example data: oceanbuoys


```r
oceanbuoys
## # A tibble: 736 × 8
##     year latitude longitude sea_temp_c air_temp_c humidity wind_ew wind_ns
##    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1  1997        0      -110       27.6       27.1     79.6   -6.40    5.40
##  2  1997        0      -110       27.5       27.0     75.8   -5.30    5.30
##  3  1997        0      -110       27.6       27       76.5   -5.10    4.5 
##  4  1997        0      -110       27.6       26.9     76.2   -4.90    2.5 
##  5  1997        0      -110       27.6       26.8     76.4   -3.5     4.10
##  6  1997        0      -110       27.8       26.9     76.7   -4.40    1.60
##  7  1997        0      -110       28.0       27.0     76.5   -2       3.5 
##  8  1997        0      -110       28.0       27.1     78.3   -3.70    4.5 
##  9  1997        0      -110       28.0       27.2     78.6   -4.20    5   
## 10  1997        0      -110       28.0       27.2     76.9   -3.60    3.5 
## # … with 726 more rows
```

---
# Start looking at missing values


```r
vis_miss(oceanbuoys)
```

&lt;img src="Workshop1-Week5_files/figure-html/vismiss-ocean-1.png" width="80%" style="display: block; margin: auto;" /&gt;

???

West Pacific Tropical Atmosphere Ocean Data, 1993 &amp; 1997, for improved detection, understanding and prediction of El Nino and La Nina, collected from [http://www.pmel.noaa.gov/tao/index.shtml](http://www.pmel.noaa.gov/tao/index.shtml)

The data has 736 observations, and 8 variables. All of the variables are numeric (including year).

???

What do we learn?

- Two variables, air temperature and humidity,  have a large number of missings.
- Year, latitude and longitude have no missings
- Sea temperature has a couple of missings
- Some rows have a lot of missings

Overall statistics, 3% of possible values are missing. That's not much. BUT, both air temperature and humidity have more than 10% missing which is too much to ignore.

This type of display is called a "heatmap", displays the data table, with cells coloured according to some other information. In this case it is type of variable, and missingness status. What do we learn?

- Most of the variables are `character` (text) variables, or `integer` variables.
- Missing values are located only in the counts, but it is in blocks, so perhaps corresponds to some category levels of the other variables.

---
# Missing value patterns


```r
gg_miss_upset(oceanbuoys)
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# Missings Tend to get ignored by most software

.left-code[

```r
ggplot(oceanbuoys,
  aes(x = sea_temp_c,
      y = humidity)) +
  geom_point() + 
  theme(aspect.ratio = 1)
```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-show-warning-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


and this is a problem, because results computed on data with missing values might be biased.

---
# Add missings to plot with `geom_miss_point()`

.left-code[

```r
ggplot(oceanbuoys,
       aes(x = sea_temp_c,
           y = humidity)) +
  scale_colour_brewer(
    palette="Dark2") +
  geom_miss_point() + 
  theme(aspect.ratio=1)
```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-ocean-show-geom-miss-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
# Facet By year


```r
ggplot(oceanbuoys,
       aes(x = sea_temp_c,
           y = humidity)) +
  geom_miss_point() + 
  scale_colour_brewer(
    palette = "Dark2") +
  facet_wrap(~year) + 
  theme(aspect.ratio=1) 
```

&lt;img src="Workshop1-Week5_files/figure-html/gg-ocean-by-year-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Understanding missing dependencies

.left-code[

```r
ggplot(oceanbuoys,
       aes(x = sea_temp_c,
           y = air_temp_c)) +
  geom_miss_point() + 
  scale_colour_brewer(
    palette="Dark2") +
  facet_wrap(~year) + 
  theme(aspect.ratio=1)

```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-ocean-year-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

???

What do we learn?

- There is a different missingness pattern in each of the years
- Year needs to be accounted for in finding good substitute values.

---
# Strategies for working with missing values

&lt;br&gt;&lt;br&gt;

.content-box-neutral[
- Small fraction of cases have several missings (around 5%) - explore data, and possibly drop the cases
- A variable or two, out of many, have a lot of missings, drop the variables
]
---
# Strategies for working with missing values

&lt;br&gt;&lt;br&gt;

.content-box-neutral[
- If missings are small in number, but located in many cases and variables, you need to impute these values, to do most analyses
- Designing the imputation should take into account dependencies that you have seen between missingness and existing variables.
- For the ocean buoys data this means imputation needs to be done separately by year
]
---
# Common ways to impute values
&lt;br&gt;&lt;br&gt;

.content-box-neutral[
- (Usually bad) Simple parametric: use the mean or median of the complete cases for each variable
- (Better) More complex: use models to predict missing values
- (Best) Multiple imputation: Use a statistical distribution, e.g. normal model and simulate a value (or set of values, hot deck imputation) for the missings.
]
---
# Setup for missings


```r
tao_shadow &lt;- bind_shadow(oceanbuoys)

tao_shadow
## # A tibble: 736 × 16
##     year latitude longitude sea_temp_c air_temp_c humidity wind_ew wind_ns
##    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1  1997        0      -110       27.6       27.1     79.6   -6.40    5.40
##  2  1997        0      -110       27.5       27.0     75.8   -5.30    5.30
##  3  1997        0      -110       27.6       27       76.5   -5.10    4.5 
##  4  1997        0      -110       27.6       26.9     76.2   -4.90    2.5 
##  5  1997        0      -110       27.6       26.8     76.4   -3.5     4.10
##  6  1997        0      -110       27.8       26.9     76.7   -4.40    1.60
##  7  1997        0      -110       28.0       27.0     76.5   -2       3.5 
##  8  1997        0      -110       28.0       27.1     78.3   -3.70    4.5 
##  9  1997        0      -110       28.0       27.2     78.6   -4.20    5   
## 10  1997        0      -110       28.0       27.2     76.9   -3.60    3.5 
## # … with 726 more rows, and 8 more variables: year_NA &lt;fct&gt;, latitude_NA &lt;fct&gt;,
## #   longitude_NA &lt;fct&gt;, sea_temp_c_NA &lt;fct&gt;, air_temp_c_NA &lt;fct&gt;,
## #   humidity_NA &lt;fct&gt;, wind_ew_NA &lt;fct&gt;, wind_ns_NA &lt;fct&gt;
```

---
# Imputing the Mean (ignoring year).
&lt;br&gt;&lt;br&gt;

```r
tao_imp_mean &lt;- tao_shadow %&gt;%
  mutate(sea_temp_c = impute_mean(sea_temp_c),
         air_temp_c = impute_mean(air_temp_c))

tao_shadow
## # A tibble: 736 × 16
##     year latitude longitude sea_temp_c air_temp_c humidity wind_ew wind_ns
##    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1  1997        0      -110       27.6       27.1     79.6   -6.40    5.40
##  2  1997        0      -110       27.5       27.0     75.8   -5.30    5.30
##  3  1997        0      -110       27.6       27       76.5   -5.10    4.5 
##  4  1997        0      -110       27.6       26.9     76.2   -4.90    2.5 
##  5  1997        0      -110       27.6       26.8     76.4   -3.5     4.10
##  6  1997        0      -110       27.8       26.9     76.7   -4.40    1.60
##  7  1997        0      -110       28.0       27.0     76.5   -2       3.5 
##  8  1997        0      -110       28.0       27.1     78.3   -3.70    4.5 
##  9  1997        0      -110       28.0       27.2     78.6   -4.20    5   
## 10  1997        0      -110       28.0       27.2     76.9   -3.60    3.5 
## # … with 726 more rows, and 8 more variables: year_NA &lt;fct&gt;, latitude_NA &lt;fct&gt;,
## #   longitude_NA &lt;fct&gt;, sea_temp_c_NA &lt;fct&gt;, air_temp_c_NA &lt;fct&gt;,
## #   humidity_NA &lt;fct&gt;, wind_ew_NA &lt;fct&gt;, wind_ns_NA &lt;fct&gt;
```

---
# Imputing the Mean (ignoring year).

.left-code[

```r
ggplot(tao_imp_mean,
       aes(x = sea_temp_c,
           y = air_temp_c, 
           colour = 
             air_temp_c_NA)) +
  geom_point(alpha = 0.7) + 
  facet_wrap(~year) + 
  scale_colour_brewer(
    palette = "Dark2") +
  theme(aspect.ratio = 1)

```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-vis-mean-imp-out-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

???

What do we learn?

- Oh, this is so wrong!
- The imputed values are nothing like the complete case values

---
# Impute Mean by year
&lt;br&gt;&lt;br&gt;

```r

tao_shadow &lt;- tao_shadow %&gt;%
  group_by(year) %&gt;%
  mutate(sea_temp_c = impute_mean(sea_temp_c),
         air_temp_c = impute_mean(air_temp_c))

head(tao_shadow, 5)
## # A tibble: 5 × 16
## # Groups:   year [1]
##    year latitude longitude sea_temp_c air_temp_c humidity wind_ew wind_ns
##   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1  1997        0      -110       27.6       27.1     79.6   -6.40    5.40
## 2  1997        0      -110       27.5       27.0     75.8   -5.30    5.30
## 3  1997        0      -110       27.6       27       76.5   -5.10    4.5 
## 4  1997        0      -110       27.6       26.9     76.2   -4.90    2.5 
## 5  1997        0      -110       27.6       26.8     76.4   -3.5     4.10
## # … with 8 more variables: year_NA &lt;fct&gt;, latitude_NA &lt;fct&gt;,
## #   longitude_NA &lt;fct&gt;, sea_temp_c_NA &lt;fct&gt;, air_temp_c_NA &lt;fct&gt;,
## #   humidity_NA &lt;fct&gt;, wind_ew_NA &lt;fct&gt;, wind_ns_NA &lt;fct&gt;
```


---
# by year
&lt;br&gt;&lt;br&gt;
.left-code[

```r
ggplot(tao_shadow,
       aes(x = sea_temp_c,
           y = air_temp_c, 
           colour=air_temp_c_NA)) +
  geom_point(alpha=0.7) + 
  facet_wrap(~year) + 
  scale_colour_brewer(
    palette="Dark2") +
  theme(aspect.ratio=1)
```
]

.right-plot[
&lt;img src="Workshop1-Week5_files/figure-html/gg-imp-mean-by-year-out-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]
.small[
- The imputed values are closer to the complete case values
- However, they form a rigid line, mismatching the variation 
- and they extend outside the range of complete values.
-This is a problem in that the imputed air temperature value for these high sea temperature cases is lower than we would expect, and thus possibly impeding good model fitting
]

---
### Relationship with other variables


```r
ggplot(data = tao_shadow,
       aes(x = wind_ew, 
           y=wind_ns, 
           colour=air_temp_c_NA)) +
       scale_colour_brewer(palette="Dark2") +
       geom_point(alpha=0.7) + theme(aspect.ratio=1) 
```

&lt;img src="Workshop1-Week5_files/figure-html/unnamed-chunk-15-1.png" width="40%" style="display: block; margin: auto;" /&gt;


- The lowest values of east-west winds have no missing values. Maybe it is less likely to have air temperature missing values when there are light east-west winds?




---

# Resources
&lt;br&gt;&lt;br&gt;

- [R-miss-Tastic](https://rmisstastic.netlify.com)
- [naniar](http://naniar.njtierney.com/)
- [visdat](http://visdat.njtierney.com/)





---
class: transition
# The many shapes and sizes of data

---
# Data as an audio file


```r
library(tuneR)
wv_data &lt;- readWave("data/data3.wav") %&gt;%
    extractWave(from = 25000, to = 75000)
df_wav_data &lt;- tibble(
  t = seq_len(length(wv_obj)),
  left = wv_obj@left,
  right = wv_obj@right,
  word = "data"
)
```


```
## Rows: 100,002
## Columns: 4
## $ t     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 1…
## $ left  &lt;int&gt; 28, 27, 26, 24, 22, 15, 15, 12, 15, 18, 20, 27, 20, 18, 18, 12, …
## $ right &lt;int&gt; 29, 28, 24, 27, 18, 19, 13, 13, 16, 16, 21, 26, 18, 22, 13, 17, …
## $ word  &lt;chr&gt; "data", "data", "data", "data", "data", "data", "data", "data", …
```


---
# Plotting audio data?

&lt;img src="Workshop1-Week5_files/figure-html/show-audio-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---
# Compare left and right channels

&lt;img src="Workshop1-Week5_files/figure-html/gg-compare-left-and-right-1.png" width="80%" style="display: block; margin: auto;" /&gt;


???

Oh, same sound is on both channels! A tad drab.

---
# Compute statistics


```
## # A tibble: 200,004 × 4
##        t word  channel value
##    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;
##  1     1 data  left       28
##  2     1 data  right      29
##  3     2 data  left       27
##  4     2 data  right      28
##  5     3 data  left       26
##  6     3 data  right      24
##  7     4 data  left       24
##  8     4 data  right      27
##  9     5 data  left       22
## 10     5 data  right      18
## # … with 199,994 more rows
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; word &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; m &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; s &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mx &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mn &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; data &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.004 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1602.577 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8393 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15386 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; statistics &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.009 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1506.626 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6601 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11026 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Music library





```
## # A tibble: 62 × 8
##    ...1           artist type       lvar  lave  lmax lfener lfreq
##    &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 Dancing Queen  Abba   Rock  17600756. -90.0 29921   106.  59.6
##  2 Knowing Me     Abba   Rock   9543021. -75.8 27626   103.  58.5
##  3 Take a Chance  Abba   Rock   9049482. -98.1 26372   102. 125. 
##  4 Mamma Mia      Abba   Rock   7557437. -90.5 28898   102.  48.8
##  5 Lay All You    Abba   Rock   6282286. -89.0 27940   100.  74.0
##  6 Super Trouper  Abba   Rock   4665867. -69.0 25531   100.  81.4
##  7 I Have A Dream Abba   Rock   3369670. -71.7 14699   105. 305. 
##  8 The Winner     Abba   Rock   1135862  -67.8  8928   104. 278. 
##  9 Money          Abba   Rock   6146943. -76.3 22962   102. 165. 
## 10 SOS            Abba   Rock   3482882. -74.1 15517   104. 147. 
## # … with 52 more rows
```

---
# Plotting music library

&lt;img src="Workshop1-Week5_files/figure-html/gg-di-music-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---
# Plot music library

&lt;img src="Workshop1-Week5_files/figure-html/gg-di-music-points-1.png" width="80%" style="display: block; margin: auto;" /&gt;

Abba is just different from everyone else!

---
# Question time:

&lt;br&gt;&lt;br&gt;
-   "How does `data` appear different than `statistics` in the time series?"
-   "What format is the data in an audio file?"
-   "How is Abba different from the other music clips?",


---
# Why look at audio data?

- Data comes in many shapes and sizes
- Audio data can be transformed ("rectangled") into a data.frame
- Try on your own music with the [spotifyr](https://github.com/charlie86/spotifyr) package!


---
# Mid-Semester Assessment

&lt;br&gt;&lt;br&gt;

- After the break in Week 6
- Week 6: Wednesday 1pm to Thursday 1pm
- You will have 45 min to complete it once you start.
- Quiz

---




background-image: url(images/daniel-olah-pCcGpVsOHoo-unsplash.jpg)
background-size: cover
class: hide-slide-number split-70
count: false

.column.shade_black[.content[

&lt;br&gt;&lt;br&gt;



.bottom_abs.width100[

Lecturer: Patricia Menéndez

Department of Econometrics and Business Statistics&lt;br&gt;





]

&lt;br /&gt;
This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License&lt;/a&gt;.

&lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /&gt;&lt;/a&gt;


]]



&lt;div class="column transition monash-m-new delay-1s" style="clip-path:url(#swipe__clip-path);"&gt;
&lt;div class="background-image" style="background-image:url('images/large.png');background-position: center;background-size:cover;margin-left:3px;"&gt;
&lt;svg class="clip-svg absolute"&gt;
&lt;defs&gt;
&lt;clipPath id="swipe__clip-path" clipPathUnits="objectBoundingBox"&gt;
&lt;polygon points="0.5745 0, 0.5 0.33, 0.42 0, 0 0, 0 1, 0.27 1, 0.27 0.59, 0.37 1, 0.634 1, 0.736 0.59, 0.736 1, 1 1, 1 0, 0.5745 0" /&gt;
&lt;/clipPath&gt;
&lt;/defs&gt;	
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLanguage": "r",
"highlightLines": true,
"highlightSpans": false,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%/%total%",
"navigation": {
"scroll": false,
"touch": true,
"click": false
},
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'assets/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
